import hashlib

# dirty cow exploit
# CVE-2016-5195
# http://www.toms-blog.com/post/dirty-cow-exploit-poc-example/
# dirtycow
# 17f03d8d940e0947cbb380fedad3140c55dae9d7
# 17f03d8d940e0947cbb380fedad3140c55dae9d7

if __name__=="__main__":
	# hash = salt + word1 + word2
	hash = "17f03d8d940e0947cbb380fedad3140c55dae9d7"

	salt = "!@#$%"
	wordFile = open("words1.txt")
	words = wordFile.readlines()
	words = [x.strip() for x in words]  #strip \n character
	wordFile.close()

	print("Starting")
	for word1 in words:
		for word2 in words:
			plainText = salt + word1 + word2

			plainText = plainText.encode(encoding='ascii',errors='strict')


			sha1   = hashlib.sha1(plainText).hexdigest()
			sha224 = hashlib.sha224(plainText)
			sha256 = hashlib.sha256(plainText)
			sha384 = hashlib.sha384(plainText)
			sha512 = hashlib.sha512(plainText)

			if(sha1 == hash or sha224 == hash):
				print(word1 + word2)
				print(sha1)
				print(hash)
				exit()
